{"ast":null,"code":"import _classCallCheck from \"/Users/baohuideng/Downloads/testdeployUDE-master 2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/baohuideng/Downloads/testdeployUDE-master 2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/baohuideng/Downloads/testdeployUDE-master 2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/baohuideng/Downloads/testdeployUDE-master 2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/baohuideng/Downloads/testdeployUDE-master 2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/baohuideng/Downloads/testdeployUDE-master 2/client/src/components/ProfileUpdate.js\";\nimport React, { Component } from 'react';\nimport { Button, Form, FormGroup, Label, Input, FormText } from 'reactstrap';\nimport jwt_decode from 'jwt-decode';\nimport axios from 'axios';\nimport { UrlContext } from '../contexts/urlContext';\n\nvar ProfileUpdate = /*#__PURE__*/function (_Component) {\n  _inherits(ProfileUpdate, _Component);\n\n  function ProfileUpdate() {\n    var _this;\n\n    _classCallCheck(this, ProfileUpdate);\n\n    var token = localStorage.usertoken;\n    var decoded = jwt_decode(token);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProfileUpdate).call(this));\n\n    _this.handleFile = function (e) {\n      var newFile = e.target.files[0];\n\n      _this.setState({\n        file: newFile\n      }, function (e) {\n        return _this.getImage(_this.state.file.name);\n      });\n    };\n\n    _this.state = {\n      'username': decoded.identity.username,\n      'email': decoded.identity.email,\n      'image': decoded.identity.file,\n      'password': '',\n      'confirmpassword': '',\n      'secondUsername': '',\n      'msg': '',\n      'serverUrl': UrlContext._currentValue,\n      'imgSuccess': ''\n    };\n    return _this;\n  }\n\n  _createClass(ProfileUpdate, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var token = localStorage.usertoken;\n      var decoded = jwt_decode(token);\n      this.setState({\n        username: decoded.identity.username,\n        email: decoded.identity.email,\n        file: decoded.identity.file\n      }, function () {\n        return _this2.getImage(_this2.state.file);\n      }, console.log(this.state.file));\n    }\n  }, {\n    key: \"getImage\",\n    value: function getImage(file) {\n      if (this.state.file !== 'images/userProfile.png') {\n        this.setState({\n          image: this.state.serverUrl + 'file/' + file\n        });\n      } else {\n        this.setState({\n          image: this.state.image\n        });\n      }\n    }\n  }, {\n    key: \"imageUpload\",\n    value: function imageUpload(file) {\n      var _this3 = this;\n\n      var newImg = \"\";\n      var email = this.state.email; // let  file = this.state.file\n\n      console.log(file);\n      var formdata = new FormData();\n      formdata.append('file', file);\n      formdata.append('email', email);\n      axios({\n        url: this.state.serverUrl + 'profileUpload',\n        method: 'POST',\n        headers: {\n          authorization: 'usertoken'\n        },\n        data: formdata\n      }).then(function (response) {\n        newImg = 'imgUploaded';\n\n        _this3.UpdateProfile(newImg);\n      });\n      this.UpdateProfile(newImg);\n    }\n  }, {\n    key: \"UpdateProfile\",\n    value: function UpdateProfile(imgState) {\n      var _this4 = this;\n\n      console.log('image changed1:', imgState);\n      var name = this.state.secondUsername;\n      name === \"\" ? name = this.state.username : name = this.state.secondUsername;\n      axios({\n        url: this.state.serverUrl + 'users/update',\n        method: 'POST',\n        headers: {\n          authorization: 'usertoken'\n        },\n        data: {\n          'username': name,\n          'email': this.state.email,\n          'password': this.state.password,\n          'confirmpassword': this.state.confirmpassword\n        }\n      }).then(function (response) {\n        _this4.setState({\n          msg: response.data.msg\n        });\n\n        console.log('image changed2:', imgState);\n\n        if (response.data.success === 'true' || imgState === 'imgUploaded') {\n          localStorage.removeItem('usertoken');\n          window.location = '/login';\n        }\n      }).catch(function (err) {\n        console.log('image changed3:', imgState);\n\n        if (imgState === 'imgUploaded') {\n          localStorage.removeItem('usertoken');\n          window.location = '/login';\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-sm-8 mx-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }\n      }, this.state.username)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-sm-8 mx-auto\",\n        style: {\n          \"display\": \"flex\",\n          \"justifyContent\": \"center\",\n          \"alignItems\": \"center\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: this.state.image,\n        style: {\n          \"width\": '40%',\n          \"height\": 'auto',\n          \"border\": 'solid 1px lightgrey',\n          \"borderRadius\": \"25%\"\n        },\n        title: this.state.username,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\",\n        style: {\n          \"display\": \"flex\",\n          \"justifyContent\": \"center\",\n          \"alignItems\": \"center\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        className: \"my-2 btn btn-secondary btn-xs\",\n        type: \"file\",\n        name: \"file\",\n        accept: \"image/png, image/jpeg\",\n        onChange: function onChange(e) {\n          return _this5.handleFile(e);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table col-md-6 mx-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 33\n        }\n      }, \"Username\"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(Input, {\n        type: \"username\",\n        name: \"username\",\n        id: \"username\",\n        placeholder: this.state.username,\n        onChange: function onChange(e) {\n          _this5.setState({\n            'secondUsername': e.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 33\n        }\n      })), \"                            \"), /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 29\n        }\n      }, \"Email\"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 33\n        }\n      }, this.state.email)), /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 29\n        }\n      }, \"Password\"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(Input, {\n        type: \"password\",\n        name: \"newPassword\",\n        id: \"newPassword\",\n        placeholder: \"new password\",\n        onChange: function onChange(e) {\n          _this5.setState({\n            'password': e.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 33\n        }\n      }))), /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 29\n        }\n      }, \"Confirm Password\"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(Input, {\n        type: \"password\",\n        name: \"confirmPassword\",\n        id: \"confirmPassword\",\n        placeholder: \"confirm password\",\n        onChange: function onChange(e) {\n          _this5.setState({\n            'confirmpassword': e.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 33\n        }\n      }))), /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        outline: true,\n        className: \"btn btn-primary mt-2\",\n        style: {\n          \"display\": \"flex\",\n          \"justifyContent\": \"center\",\n          \"alignItems\": \"center\"\n        },\n        size: \"lg\",\n        onClick: function onClick() {\n          _this5.imageUpload(_this5.state.file); // this.UpdateProfile();\n\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 33\n        }\n      }, \"update\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \" my-2\",\n        style: {\n          color: '#E67E22'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 29\n        }\n      }, \" \", this.state.msg))));\n    }\n  }]);\n\n  return ProfileUpdate;\n}(Component);\n\nexport { ProfileUpdate as default };","map":{"version":3,"sources":["/Users/baohuideng/Downloads/testdeployUDE-master 2/client/src/components/ProfileUpdate.js"],"names":["React","Component","Button","Form","FormGroup","Label","Input","FormText","jwt_decode","axios","UrlContext","ProfileUpdate","token","localStorage","usertoken","decoded","handleFile","e","newFile","target","files","setState","file","getImage","state","name","identity","username","email","_currentValue","console","log","image","serverUrl","newImg","formdata","FormData","append","url","method","headers","authorization","data","then","response","UpdateProfile","imgState","secondUsername","password","confirmpassword","msg","success","removeItem","window","location","catch","err","value","imageUpload","color"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Button, Form, FormGroup, Label, Input, FormText } from 'reactstrap';\nimport jwt_decode from 'jwt-decode';\nimport axios from 'axios';\nimport { UrlContext } from '../contexts/urlContext';\n\n\nexport default class ProfileUpdate extends Component{\n\n    \n\n\n    constructor() {\n        const token = localStorage.usertoken\n        const decoded = jwt_decode(token)\n            super()\n            this.state = {\n                'username':decoded.identity.username,\n                'email': decoded.identity.email,\n                'image':decoded.identity.file,\n                'password':'',\n                'confirmpassword':'',\n                'secondUsername':'',\n                'msg':'',\n                'serverUrl': UrlContext._currentValue,\n                'imgSuccess':'',\n\n            }\n        }\n\n        componentDidMount () {\n            const token = localStorage.usertoken\n            const decoded = jwt_decode(token)\n            this.setState({\n                username: decoded.identity.username,\n                email: decoded.identity.email,\n                file:decoded.identity.file\n            },()=>this.getImage(this.state.file), console.log(this.state.file))\n            \n        }\n\n\n        getImage(file){\n            if(this.state.file!=='images/userProfile.png'){\n                this.setState({\n                    image: this.state.serverUrl +'file/'+ file\n                })\n             }\n             else{\n                this.setState({\n                    image: this.state.image\n                })\n             }\n        }\n    \n      \n        handleFile = (e) => {\n            const newFile =e.target.files[0]\n            this.setState({\n                file:newFile,\n            },(e)=>this.getImage(this.state.file.name));\n        }\n    \n        imageUpload(file){\n            let newImg=\"\"\n            let email = this.state.email\n            // let  file = this.state.file\n            console.log(file)\n            let formdata = new FormData()\n            formdata.append('file',file)\n            formdata.append('email',email)\n            axios({\n                url: this.state.serverUrl +'profileUpload',\n                method: 'POST',\n                headers:{\n                    authorization:'usertoken'\n                },\n                data:formdata\n    \n            }).then(response => {\n                \n                newImg='imgUploaded'\n                this.UpdateProfile(newImg)\n        \n            })\n            this.UpdateProfile(newImg)\n            \n        }\n\n\n    UpdateProfile(imgState){\n        console.log('image changed1:',imgState)\n        var name = this.state.secondUsername\n        name===\"\"? name=this.state.username:name=this.state.secondUsername\n        \n        axios({\n            url: this.state.serverUrl +'users/update',\n            method: 'POST',\n            headers:{\n                authorization:'usertoken'\n            },\n            data:{\n                'username':name,\n                'email':this.state.email,\n                'password':this.state.password,\n                'confirmpassword':this.state.confirmpassword\n            }\n            \n        }).then(response => {\n            this.setState({\n                msg:response.data.msg\n            })\n            console.log('image changed2:',imgState)\n            \n            if (response.data.success ==='true' || imgState==='imgUploaded') {\n                localStorage.removeItem('usertoken')\n                window.location = '/login';\n            }\n            \n        })\n        .catch(err => {\n            console.log('image changed3:',imgState)\n            if (imgState==='imgUploaded') {\n                localStorage.removeItem('usertoken')\n                window.location = '/login';\n            }\n        })\n\n    }\n\n\n\n    render() {\n        return (\n            <div>\n                <div className=\"col-sm-8 mx-auto\">\n                    <h2 className=\"text-center\">{this.state.username}</h2>\n                </div>\n\n                <div className=\"col-sm-8 mx-auto\" style={{\"display\":\"flex\", \"justifyContent\": \"center\", \"alignItems\": \"center\"}}>\n                    <img src={this.state.image} style={{ \"width\":'40%',\"height\":'auto', \"border\":'solid 1px lightgrey', \"borderRadius\": \"25%\"}} title={this.state.username}/> \n                </div> \n                <br></br> \n\n                \n                \n                \n                <div className=\"\" style={{\"display\":\"flex\", \"justifyContent\": \"center\", \"alignItems\": \"center\"}}>\n                    {/* <label>Chane Image</label><br/> */}\n                    <input className=\"my-2 btn btn-secondary btn-xs\" \n                    type=\"file\" name=\"file\"\n                    accept=\"image/png, image/jpeg\" onChange={(e)=>this.handleFile(e)}/>\n                    {/* Change Image</button> */}\n                </div>\n\n                <table className=\"table col-md-6 mx-auto\">\n                        <tbody>\n                            <tr>\n                                <td>Username</td>\n                                <td>\n                                <Input type=\"username\" name=\"username\" id=\"username\" placeholder={this.state.username} onChange={e => {this.setState({'secondUsername': e.target.value})}} />\n                            </td>                            </tr>\n                            <tr>\n                            <td>Email</td>\n                                <td>{this.state.email}</td>\n                           \n                            </tr>\n                            <tr>\n                            <td>Password</td>\n                            <td>\n                                <Input type=\"password\" name=\"newPassword\" id=\"newPassword\" placeholder=\"new password\" onChange={e => {this.setState({'password': e.target.value})}}/></td>\n                            </tr>\n                            <tr>\n                            <td>Confirm Password</td>\n                            <td>\n                                <Input type=\"password\" name=\"confirmPassword\" id=\"confirmPassword\" placeholder=\"confirm password\" onChange={e => {this.setState({'confirmpassword':e.target.value})}} /></td>\n                            </tr>\n                            <tr>\n                            <td></td>\n                            <td>\n                               {/* <Button outline color=\"secondary\" size=\"sm\" onClick={this.props.clickMe}>update</Button>*/}\n                                <Button outline className='btn btn-primary mt-2' \n                                style={{\"display\":\"flex\", \"justifyContent\": \"center\", \"alignItems\": \"center\"}} \n                                size=\"lg\" \n                                onClick={()=>{\n                                    this.imageUpload(this.state.file);\n                                    // this.UpdateProfile();\n                                    }} >update</Button>\n\n                            </td>\n                            </tr>\n                            <div className=\" my-2\" style={{color:'#E67E22'}}> {this.state.msg}</div>\n\n\n                        </tbody>\n                    </table>\n                  </div>\n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}